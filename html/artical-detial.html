<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>文章详情 - 个人网站</title>
    <link type="text/css" rel="stylesheet" href="../css/common.css"/>
    <link type="text/css" rel="stylesheet" href="../css/artical-detial.css"/>
    <script type="text/javascript" src="../script.js"></script>
    <!-- 引入图标样式文件 -->
    <link type="text/css" rel="stylesheet" href="../iconfont/iconfont.css">
</head>
<body class="background">    
        <div data-include="partials/header.html"></div>
         <!-- 内容区域 --> 
        <div class="container"><!-- 中间容器 --> 
            <div class="artical-detial-container">
                <div class="title" id="article-title">加载中...</div>
                <div class="time-container">
                      <span class="iconfont icon-shijian"></span>
                      <p id="article-date">加载中...</p>
                  </div>
                <!-- 封面图片已移除 -->
                <div class="artical-container" id="article-content">
                    <p>正在加载文章内容...</p>
                </div>
            </div>
           
 
        </div>
         <!--底部-->
        <div data-include="partials/footer.html"></div>         
    
    <script>
        // 获取URL中的文章ID参数
        function getArticleId() {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get('id');
        }
        
        // 备用文章数据
        const fallbackArticles = {
            '1': {
                id: 1,
                title: "巨湾科技荣获中国测绘学会'2023年测绘科学技术奖'一等奖、二等奖",
                publishDate: "2023-12-20T00:00:00.000Z",
                createdAt: "2023-12-20T00:00:00.000Z",
                cover: "../img/article-img.png",
                content: "近日，中国测绘学会'2023年测绘科学技术奖'评选结果公布。深圳巨湾科技有限公司凭借'自然资源资产全价值评估核算关键技术及应用'项目、'空天地一体化时空数据智能处理技术及其测绘国际应用'项目分别荣获2023年测绘科学技术奖一等奖、二等奖。\n\n自然资源资产全价值评估核算关键技术及应用项目针对当前自然资源资产管理和生态产品价值实现的重大需求，系统构建了自然资源资产全价值评估核算理论体系，研发了多源数据融合处理技术、生态系统服务价值精准评估模型和全流程核算决策支持系统。该技术已在全国多个省市开展示范应用，为自然资源资产管理体制改革和生态产品价值实现机制创新提供了重要支撑。\n\n空天地一体化时空数据智能处理技术及其测绘国际应用项目整合了卫星遥感、航空摄影和地面测量等多源数据，开发了高性能时空数据智能处理引擎和分布式计算框架，实现了多尺度、高精度的地理空间信息快速获取和处理。该技术已成功应用于'一带一路'沿线国家的基础测绘和地理信息服务，显著提升了我国测绘技术的国际影响力。\n\n巨湾科技作为国内领先的空间信息与地理信息技术企业，始终坚持创新驱动发展战略，持续加大研发投入，积极推动测绘地理信息技术在自然资源管理、智慧城市建设、生态环境保护等领域的深度应用。此次获奖是对公司技术实力和创新能力的充分肯定，也是公司在推动测绘地理信息科技进步过程中取得的又一重要成果。"
            },
            '2': {
                id: 2,
                title: "人工智能在城市规划中的创新应用与实践",
                publishDate: "2023-11-15T00:00:00.000Z",
                createdAt: "2023-11-15T00:00:00.000Z",
                cover: "../img/ai.png",
                content: "本文探讨了人工智能技术如何在现代城市规划中发挥关键作用，通过数据分析和机器学习算法优化城市布局、交通系统和公共服务，实现智慧城市的可持续发展。\n\n随着城市化进程的加速和城市规模的不断扩大，传统的城市规划方法面临着数据量大、决策复杂、预测精度低等挑战。人工智能技术的出现为解决这些问题提供了新的思路和方法。通过对城市各类数据的智能分析，可以更准确地预测城市发展趋势，优化城市功能布局，提高城市运行效率。\n\n在交通规划领域，人工智能技术可以通过分析交通流量数据、出行行为数据和道路网络数据，预测交通拥堵状况，优化信号灯控制，合理规划公交线路，从而提高交通系统的整体效率。例如，某一线城市通过引入深度学习算法优化交通信号控制系统，使主要道路的通行效率提升了25%，高峰时段拥堵时间减少了30%。\n\n在城市空间布局优化方面，人工智能技术可以综合考虑人口分布、经济活动、生态环境等多种因素，生成最优的城市功能分区方案。通过智能算法模拟不同规划方案的长期影响，可以为城市规划决策提供科学依据，避免传统规划方法中的主观性和经验依赖性。\n\n在公共服务配置方面，人工智能技术可以基于人口密度、年龄结构、收入水平等数据，预测不同区域对教育、医疗、文化等公共服务设施的需求，从而实现公共资源的精准配置，提高公共服务的公平性和可及性。\n\n当然，人工智能技术在城市规划中的应用也面临着数据质量、算法透明度、隐私保护等挑战。未来，需要加强跨学科合作，建立完善的数据标准和伦理规范，推动人工智能技术与城市规划的深度融合，为建设更智能、更宜居、更可持续的城市提供技术支撑。"
            },
            '3': {
                id: 3,
                title: "数字孪生技术在工业制造中的实施案例研究",
                publishDate: "2023-10-08T00:00:00.000Z",
                createdAt: "2023-10-08T00:00:00.000Z",
                cover: "../img/work_img.png",
                content: "数字孪生技术作为工业4.0的核心组成部分，正在改变传统制造业的生产模式。本文通过多个行业领先企业的实际案例，深入分析了数字孪生技术的实施路径和价值创造。\n\n数字孪生是指在虚拟空间中创建物理实体的数字映射，通过实时数据交互和仿真分析，实现对物理实体的监控、预测和优化。在工业制造领域，数字孪生技术可以应用于产品设计、生产制造、设备维护、供应链管理等各个环节，显著提升生产效率和产品质量。\n\n某汽车制造商通过构建整车数字孪生系统，实现了从设计到生产的全流程数字化管理。在产品设计阶段，通过数字孪生模型进行虚拟测试和仿真分析，减少了物理原型的数量，缩短了产品开发周期；在生产制造阶段，通过实时监控生产设备和生产线的运行状态，及时发现并解决潜在问题，提高了生产效率和产品合格率；在售后服务阶段，通过车辆数字孪生模型分析用户使用数据，预测可能出现的故障，提供个性化的维护建议，提升了用户满意度。\n\n某重型装备制造企业通过为关键生产设备建立数字孪生模型，实现了设备的预测性维护。通过传感器实时采集设备运行数据，结合历史故障数据和机器学习算法，准确预测设备可能出现故障的时间和部位，提前制定维护计划，避免了非计划性停机，降低了维护成本。实施数字孪生技术后，该企业设备的计划停机时间减少了40%，维护成本降低了25%。\n\n某电子制造企业通过构建供应链数字孪生系统，优化了供应链管理。通过实时监控原材料库存、生产进度、物流运输等数据，预测供应链可能面临的风险，及时调整采购和生产计划，提高了供应链的响应速度和韧性。在新冠疫情期间，该企业依靠数字孪生系统快速调整供应链策略，成功应对了全球供应链中断的挑战。\n\n通过这些案例可以看出，数字孪生技术在工业制造中的应用已经取得了显著成效。未来，随着5G、物联网、人工智能等技术的发展和融合，数字孪生技术将在更广泛的领域发挥更大的作用，推动制造业向数字化、网络化、智能化方向转型升级。"
            }
        };
        
        // 从API获取文章详情
        async function fetchArticleDetail(id) {
            try {
                // 优先从API获取最新数据
                try {
                    const response = await fetch(`http://8.136.34.190:3000/api/articles/${id}`);
                    
                    if (response.ok) {
                        let articleDetail = await response.json();
                        
                        // 正确处理API返回的数据格式
                        if (articleDetail.success && articleDetail.data) {
                            articleDetail = articleDetail.data;
                        } else if (articleDetail.data) {
                            articleDetail = articleDetail.data;
                        }
                        
                        // 检查文章状态，只显示已发布的文章
                        if (articleDetail.status === true || articleDetail.status === 'published') {
                            console.log('成功从API获取文章:', articleDetail);
                            renderArticle(articleDetail);
                            return; // 成功获取后直接返回，不再使用备用数据
                        } else {
                            console.warn('文章未发布或状态不正确');
                        }
                    } else if (response.status === 404) {
                        console.warn('文章不存在');
                    }
                } catch (apiError) {
                    console.error('从API获取文章详情失败:', apiError);
                    // API失败后尝试使用备用数据
                }
                
                // API调用失败或文章不存在时，使用备用数据
                console.log('使用备用数据显示文章');
                const fallbackArticle = fallbackArticles[id] || fallbackArticles['1'];
                
                if (fallbackArticle) {
                    renderArticle(fallbackArticle);
                } else {
                    console.error('找不到对应的备用文章数据');
                    document.getElementById('article-title').textContent = '文章不存在';
                    document.getElementById('article-content').innerHTML = '<p>文章不存在或已被删除</p>';
                }
            } catch (error) {
                console.error('显示文章失败:', error);
                document.getElementById('article-title').textContent = '加载失败';
                document.getElementById('article-content').innerHTML = '<p>抱歉，文章加载失败，请稍后重试。</p>';
            }
        }
        
        // 渲染文章内容
        function renderArticle(article) {
            // 设置页面标题
            document.title = `${article.title} - 个人网站`;
            
            // 填充文章内容
            document.getElementById('article-title').textContent = article.title;
            
            // 格式化日期显示
            const formattedDate = new Date(article.createdAt).toLocaleDateString('zh-CN', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            document.getElementById('article-date').textContent = formattedDate;
            
            // 封面图片已移除 - 不再显示文章封面图片
            
            // 填充文章内容
            const contentContainer = document.getElementById('article-content');
            // 如果content是HTML格式直接使用，否则包装在p标签中
            if (article.content && (article.content.includes('<p>') || article.content.includes('<div>'))) {
                contentContainer.innerHTML = article.content;
            } else {
                // 将纯文本转换为段落格式
                const paragraphs = (article.content || '').split('\n').filter(p => p.trim());
                if (paragraphs.length > 0) {
                    contentContainer.innerHTML = paragraphs.map(p => `<p>${p}</p>`).join('');
                } else {
                    contentContainer.innerHTML = '<p>暂无内容</p>';
                }
            }
        }
        
        // 页面加载完成后获取文章
        document.addEventListener('DOMContentLoaded', () => {
            const articleId = getArticleId();
            if (articleId) {
                fetchArticleDetail(articleId);
            } else {
                document.getElementById('article-title').textContent = '参数错误';
                document.getElementById('article-content').innerHTML = '<p>无效的文章ID</p>';
            }
        });
    </script>

</body>
</html>